<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FB Graphics: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FB Graphics
   </div>
   <div id="projectbrief">FBGraphics (FBG) : Simple C 16, 24, 32 bpp generic graphics library with parallelism support and custom backend.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="README_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;FBGraphics : Lightweight C 2D graphics API agnostic library with parallelism support</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;=====</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;FBGraphics (FBG) is a simple C 24, 32 bpp (internal format) graphics library with parallelism and custom rendering backend support (graphics API agnostic).</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;The library is only two .c files on most use cases, the renderer agnostic library `fbgraphics.c` and one of the rendering backend found in `custom_backend` directory.</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;The library come with five backend (see `custom_backend` folder) : </div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; * a Linux framebuffer rendering backend (with 16 bpp support through 24/32 bpp conversion)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; * OpenGL backend which use the [GLFW](http://www.glfw.org/) library</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; * OpenGL ES 2.0 backend for fbdev or Raspberry PI</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; * fast dispmanx backend (Video Core IV; Raspberry PI)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; * GBA backend (slow due to 24/32 bpp -&gt; 16 bpp support, mostly done as a proof of concept for portability on low memory hardware)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Features :</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; * Easy to write / use custom rendering backend support flexible enough to target low memory hardware!</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; * Cross-platform with the GLFW backend (some examples may need to be adapted to the target OS)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; * Linux framebuffer (fbdev) rendering backend support</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    * Double buffering (with optional page flipping mechanism)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    * 16, 24 (BGR/RGB), 32 bpp support</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; * GBA rendering backend</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; * OpenGL rendering backend through GLFW</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; * OpenGL ES 2.0 rendering backend for Raspberry PI or through fbdev (tested on Nano PI Fire 3 board)</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; * dispmanx rendering backend (Video Core IV; Raspberry PI)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; * Optional : Full parallelism, execute graphics code on multiple CPU cores **with a single function**</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; * PNG/JPEG images loading (provided by [LodePNG](https://lodev.org/lodepng/) and [NanoJPEG](http://keyj.emphy.de/nanojpeg/))</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; * Bitmap fonts for drawing texts</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; * Bare-metal graphics primitive (pixels, rectangles, lines, polygon)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; * Easy to do fading, clipping and screen-clearing related effects (motion blur etc.)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; * Drawing calls can be used to render into a specified target buffer such as fbg_image etc.</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; * Framerate tracking &amp; display for all cores</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; * Lightweight enough to be hackable; adapt to all kinds of needs (and still support parallelism easily)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;The library is generic, most functions (including parallel ones) only manipulate buffers and you can build a custom rendering backend pretty easily with few functions call, see the `custom_backend` folder.</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;Table of Contents</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;=================</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;* FBGraphics</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   * [About](#about)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      * [Quickstart](#quickstart)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      * [Parallelism](#parallelism)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      * [Technical implementation](#technical-implementation)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   * [Benchmark](#benchmark)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   * [Documentation](#documentation)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   * [Building](#building)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   * [Rendering backend](#Rendering-backend)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   * [GLFW backend](#GLFW-backend)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   * [OpenGL ES 2.0 backend](#OpenGL-ES-2-backend)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   * [Screenshots](#screenshots)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   * [License](#license)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;## About</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;FBGraphics was built to produce fullscreen pixels effects easily (think of Processing-like creative coding etc.) with non-accelerated framebuffer by leveraging multi-core processors, it is a bit like a software GPU but much less complex and featured, the initial target platform was a Raspberry PI 3B / NanoPI.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;FBGraphics was extended to support any numbers of custom rendering backend; all graphics calls manipulate internal buffers and a simple interface allow to draw the result the way you want to.</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;FBGraphics can support low memory hardware such as GBA. It should be noted that all internal buffers are manipulated in 24/32 bpp so it has to convert to 16bpp on GBA.</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;An OpenGL rendering backend which use the [GLFW library](http://www.glfw.org/) was created to demonstrate the custom backend feature, it allow to draw the non-accelerated FB Graphics buffer into an OpenGL context through a texture and thus allow to interwine 3D or 2D graphics produced with standard OpenGL calls with CPU-only graphics produced by FBGraphics draw calls.</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;An OpenGL ES 2.0 backend is also available with similar features, it target platforms with support for OpenGL ES 2.0 through fbdev (tested on Nano PI Fire 3 SBC) or Raspberry PI dispmanx and similar platforms, it wouldn&#39;t be hard to extend this for more OpenGL ES 2.0 platforms...</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;There is also a dispmanx backend targeting Raspberry PI, it have better performances than the OpenGL ES 2 backend on this platform and is recommended if you don&#39;t need 3D stuff.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;FBGraphics was built so that it is possible to create any number of rendering context using different backend running at the same time while exploiting multi-core processors... the content of any rendering context can be transfered into other context through images when calling `fbg_drawInto`</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;FBGraphics framebuffer settings support 16, 24 (BGR/RGB), 32 bpp, 16 bpp mode is handled by converting from 24 bpp to 16 bpp upon drawing, page flipping mechanism is disabled in 16 bpp mode, **24 bpp is the fastest mode**.</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;FBGraphics is lightweight and does not intend to be a fully featured graphics library, it provide a limited set of graphics primitive and a small set of useful functions to start doing computer graphics anywhere right away with or without multi-core support.</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;If you want to use the parallelism features with advanced graphics primitives, take a look at great libraries such as [libgd](http://libgd.github.io/), [Adafruit GFX library](https://github.com/adafruit/Adafruit-GFX-Library) or even [ImageMagick](https://imagemagick.org) which should be easy to integrate.</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;FBGraphics is fast but should be used with caution, display bounds checking is not implemented on most primitives, this allow raw performances at the cost of crashs if not careful.</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;Multi-core support is optional and is only enabled when `FBG_PARALLEL` C definition is present.</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;FBGraphics framebuffer backend support a mechanism known as page flipping, it allow fast double buffering by doubling the framebuffer virtual area, it is disabled by default because it is actually slower on some devices. You can enable it with a `fbg_fbdevSetup` call.</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;VSync is automatically enabled if supported.</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;**Note** : FBGraphics framebuffer backend does not let you setup the framebuffer, it expect the framebuffer to be configured prior launch with a command such as :</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;```</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;fbset -fb /dev/fb0 -g 512 240 512 240 24 -vsync high</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;setterm -cursor off &gt; /dev/tty0</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;```</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;`fbset` should be available in your package manager.</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;### Framebuffer Quickstart</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;The simplest example (no parallelism, without texts and images) :</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;```c</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;#include &lt;sys/stat.h&gt;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;#include &lt;signal.h&gt;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;#include &quot;fbg_fbdev.h&quot;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;#include &quot;fbgraphics.h&quot;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;int keep_running = 1;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;void int_handler(int dummy) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    keep_running = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;int main(int argc, char* argv[]) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    signal(SIGINT, int_handler);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    struct _fbg *fbg = fbg_fbdevSetup(&quot;/dev/fb0&quot;, 0); // you can also directly use fbg_fbdevInit(); for &quot;/dev/fb0&quot;, last argument mean that will not use page flipping mechanism  for double buffering (it is actually slower on some devices!)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    do {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        fbg_clear(fbg, 0); // can also be replaced by fbg_fill(fbg, 0, 0, 0);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        fbg_draw(fbg);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        fbg_rect(fbg, fbg-&gt;width / 2 - 32, fbg-&gt;height / 2 - 32, 16, 16, 0, 255, 0);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        fbg_pixel(fbg, fbg-&gt;width / 2, fbg-&gt;height / 2, 255, 0, 0);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        fbg_flip(fbg);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    } while (keep_running);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    fbg_close(fbg);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    return 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;```</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;A simple quickstart example with most features (but no parallelism, see below) :</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;```c</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;#include &lt;sys/stat.h&gt;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;#include &lt;signal.h&gt;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;#include &quot;fbg_fbdev.h&quot;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;#include &quot;fbgraphics.h&quot;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;int keep_running = 1;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;void int_handler(int dummy) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    keep_running = 0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;int main(int argc, char* argv[]) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    signal(SIGINT, int_handler);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    struct _fbg *fbg = fbg_fbdevInit();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    struct _fbg_img *texture = fbg_loadImage(fbg, &quot;texture.png&quot;);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    struct _fbg_img *bb_font_img = fbg_loadImage(fbg, &quot;bbmode1_8x8.png&quot;);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    struct _fbg_font *bbfont = fbg_createFont(fbg, bb_font_img, 8, 8, 33);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    do {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        fbg_clear(fbg, 0);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        fbg_draw(fbg);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        // you can also use fbg_image(fbg, texture, 0, 0)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        // but you must be sure that your image size fit on the display</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        fbg_imageClip(fbg, texture, 0, 0, 0, 0, fbg-&gt;width, fbg-&gt;height);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        fbg_write(fbg, &quot;Quickstart example\nFPS:&quot;, 4, 2);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        fbg_write(fbg, fbg-&gt;fps_char, 32 + 8, 2 + 8);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        fbg_rect(fbg, fbg-&gt;width / 2 - 32, fbg-&gt;height / 2 - 32, 16, 16, 0, 255, 0);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        fbg_pixel(fbg, fbg-&gt;width / 2, fbg-&gt;height / 2, 255, 0, 0);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        fbg_flip(fbg);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } while (keep_running);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    fbg_freeImage(texture);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    fbg_freeImage(bb_font_img);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    fbg_freeFont(bbfont);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    fbg_close(fbg);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    return 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;```</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;**Note** : Functions like `fbg_clear` or `fbg_fpixel` are fast functions, there is slower equivalent (but more parametrable) such as `fbg_background` or `fbg_pixel`, some functions variant also support transparency such as ``fbg_pixela` or `fbg_recta`.</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;**Note** : You can generate monospace bitmap fonts to be used with `fbg_createFont` function by using my [monoBitmapFontCreator](https://github.com/grz0zrg/monoBitmapFontCreator) tool available [here](https://fbg-bitmap-font-creator.netlify.com/)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;### Parallelism</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;Exploiting multiple cores with FBGraphics is really easy, first you have to prepare 3 functions (of which two are optional if you don&#39;t have any allocations to do) of the following definition :</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;```c</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;// optional function</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;void *fragmentStart(struct _fbg *fbg) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    // typically used to allocate your per-thread data</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    // see full_example.c for more informations</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    return NULL; // return your user data here</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;```</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;```c</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;void fragment(struct _fbg *fbg, struct _fragment_user_data *user_data) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    // this function will be executed by each threads</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    // you are free to call any FBG graphics primitive here</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    fbg_clear(fbg, 0);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    // you are also free to fill each threads back buffer the way you want to</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    // fbg-&gt;task_id : thread identifier (starting at 1, 0 is reserved for the main thread)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    // each threads will draw an horizontal line, the shade of the blue color will change based on the thread it is drawn from</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    int x = 0, y = 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    for (y = fbg-&gt;task_id; y &lt; fbg-&gt;height; y += 4) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        for (x = 0; x &lt; fbg-&gt;width; x += 1) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            int i = (x + y * fbg-&gt;width) * 3;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            fbg-&gt;back_buffer[i] = fbg-&gt;task_id * 85; // note : BGR format</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            fbg-&gt;back_buffer[i + 1] = 0;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            fbg-&gt;back_buffer[i + 2] = 0;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    // simple graphics primitive (4 blue rectangle which will be handled by different threads in parallel)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    fbg_rect(fbg, fbg-&gt;task_id * 32, 0, 32, 32, 0, 0, 255);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;```</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;```c</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;// optional function</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;void fragmentStop(struct _fbg *fbg, struct _fragment_user_data *data) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    // typically used to free your per-thread data</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    // see full_example.c for more informations</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;```</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;Then you have to create a &#39;Fragment&#39; which is a FBG multi-core task :</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;```c</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;fbg_createFragment(fbg, fragmentStart, fragment, fragmentStop, 3);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;```</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;Where :</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;* `fbg` is the main library data structure returned by `fbg_customSetup` and any backend `fbg_backendnameSetup` calls (see available backends in `custom_backend` directory)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;* `fragmentStart`is a C function which will be executed when the thread start (can be NULL)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;* `fragment`is a C function which will be executed indefinitly for each threads and where all the draw code will happen</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;* `fragmentStop` is a C function which will be executed when the thread end  (can be NULL)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;* `3`is the number of parallel tasks (this will launch 3 threads)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;And finally you just have to make a call to your fragment function in your drawing loop and call  `fbg_draw`!</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;```c</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;fragment(fbg, NULL);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;fbg_draw(fbg, NULL);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;```</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;`fbg_draw` will wait until all the data are received from all the threads then draw to screen</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;**Note** : This example will use 4 threads (including your app one) for drawing things on the screen but calling the fragment function in your drawing loop is totally optional, you could for example make use of threads for intensive drawing tasks and just use the main thread to draw the GUI or the inverse etc. it is up to you!</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;And that is all you have to do!</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;See `simple_parallel_example.c` and `full_example.c` for more informations.</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;**Note** : By default, the resulting buffer of each tasks are additively mixed into the main back buffer, you can override this behavior by specifying a mixing function as the last argument of `fbg_draw` such as :</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;```c</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;// function called for each tasks in the fbg_draw function</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;void selectiveMixing(struct _fbg *fbg, unsigned char *buffer, int task_id) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    // fbg is the main fbg structure returned by fbg_customSetup calls and any backend setup calls</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    // buffer is the current task buffer</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    // task_id is the current task id</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    int j = 0;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    for (j = 0; j &lt; fbg-&gt;size; j += 1) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        fbg-&gt;back_buffer[j] = (fbg-&gt;back_buffer[j] &gt; buffer[j]) ? fbg-&gt;back_buffer[j] : buffer[j];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;```</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;Then you just have to specify it to the `fbg_draw` function :</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;```c</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;fbg_draw(fbg, additiveMixing);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;```</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;By using the mixing function, you can have different layers handled by different cores with different compositing rule, see `compositing.c` for an example of alpha blending compositing 2 layers running on their own cores.</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;**Note** : You can only create one Fragment per fbg instance, another call to `fbg_createFragment` will stop all tasks for the passed fbg context and will create a new set of tasks.</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;**Note** : On low performances platforms you may encounter performance issues at high resolution and with a high number of fragments, this is because all the threads buffer need to be mixed back onto the main thread before being displayed and at high resolution / threads count that is alot of pixels to process! You can see an alternative implementation using pure pthread in the `custom_backend` folder and `dispmanx_pure_parallel.c` but it doesn&#39;t have compositing. If your platform support some sort of SIMD instructions you could also do all the compositing using SIMD which should result in a 5x or more speed increase!</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;### Technical implementation</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;FBGraphics threads come with their own fbg context data which is essentialy a copy of the actual fbg context, they make use of C atomic types.</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;Initially parallelism was implemented using [liblfds](http://liblfds.org/) library for its Ringbuffer and Freelist data structure.</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;Now parallelism has two implementation, liblfds and a custom synchronization mechanism which has the advantage to not require additional libraries and thus execute on more platforms.</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;You can still use the liblfds implementation using the `FBG_LFDS` define, it may be faster.</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;#### With liblfds</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;Each threads begin by fetching a pre-allocated buffer from a freelist, then the fragment function is called to fill that buffer, the thread then place the buffer into a ringbuffer data structure which will be fetched upon calling `fbg_draw`, the buffers are then mixed into the main back buffer and put back into the freelist.</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;#### Without liblfds</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;Each threads fragment function is called to fill the local buffer, each threads then wait till that buffer is consumed by the main thread upon calling `fbg_draw`, the buffers are then mixed into the main back buffer and `fbg_draw` wake up all threads.</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;## Benchmark (framebuffer)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;A simple unoptimized per pixels screen clearing with 4 cores on a Raspberry PI 3B :  30 FPS @ 1280x768 and 370 FPS @ 320x240</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;Note : Using the dispmanx backend a screen clearing + rectangle moving on a Raspberry PI 3B : 60 FPS @ 1920x1080</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;### Full example</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;Fullscreen per pixels perlin noise with texture mapping and scrolling (unoptimized)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;**Device** : Raspberry PI 3B ( Quad Core 1.2GHz )</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;**Settings** : 320x240</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;| Cores used to draw graphics | FPS     |</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;| :-------------------------- | :------ |</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;| 1                           | 42 FPS  |</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;| 2                           | 81 FPS  |</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;| 3                           | 120 FPS |</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;See screenshots below.</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;### Tunnel example</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;Fullscreen texture-mapped and animated tunnel made of 40800 2px rectangles with motion blur (unoptimized)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;**Device** : Raspberry PI 3B ( Quad Core 1.2GHz )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;**Settings** : 320x240</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;| Cores used to draw graphics | FPS     |</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;| :-------------------------- | :------ |</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;| 1                           | 36 FPS  |</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;| 2                           | 69 FPS  |</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;| 3                           | 99 FPS |</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;| 4                           | 66 FPS |</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;Note : The framerate drop with 4 cores is due to the main thread being too busy which make all the other threads follow due to the synchronization.</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;See screenshots below.</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;## Documentation</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;All usable functions and structures are documented in the `fbgraphics.h` file with [Doxygen](http://www.stack.nl/~dimitri/doxygen/)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;The HTML documentation can be found in the `docs` directory.</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;Examples demonstrating all features are available in the `examples` directory.</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;Some effects come from [my Open Processing sketches](https://www.openprocessing.org/user/130883#sketches)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;## Building</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;C11 standard should be supported by the C compiler.</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;All examples found in `examples` directory make use of the framebuffer device `/dev/fb0` and can be built by typing `make` into the examples directory then run them by typing `./run_quickstart` for example (this handle the framebuffer setup prior launch), you will need to compile liblfds for the parallelism features. (see below)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;All examples were tested on a Raspberry PI 3B with framebuffer settings : 320x240 24 bpp</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;For the default build (no parallelism), FBGraphics come with a header file `fbgraphics.h` and a C file `fbgraphics.c` to be included / compiled / linked with your program plus one of the rendering backend found in `custom_backend` directory, you will also need to compile the `lodepng.c` library and `nanojpeg.c` library, see the examples directory for examples of Makefile.</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;For parallelism support, `FBG_PARALLEL` need to be defined.</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;If you need to use the slightly different parallelism implementation (see technical implementation section) you will need the [liblfds](http://liblfds.org/) library :</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; * Get latest liblfds 7.1.1 package on the official website</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; * uncompress, go into the directory `liblfds711`</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; * go into the directory `build/gcc_gnumake`</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; * type `make` in a terminal</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; * `liblfds711.a` can now be found in the `bin` directory, you need to link against it when compiling (see examples)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;To compile liblfds parallel examples, just copy `liblfds711.a` / `liblfds711.h` file and `liblfds711` directory into the `examples` directory then type `make lfds711`.</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;**Note** : FBGraphics with liblfds work on ARM64 platforms but you will need liblfds720 which is not yet released.</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;### Executable size optimization</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;This library may be used for size optimized executable for things like [demos](https://en.wikipedia.org/wiki/Demoscene)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;PNG and JPEG support can be disabled with the `WITHOUT_JPEG` and `WITHOUT_PNG` define.</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;See `tiny` makefile rule inside the `custom_backend` or `examples` folder for some compiler optimizations related to executable size.</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;Under Linux [sstrip](https://github.com/BR903/ELFkickers/tree/master/sstrip) and [UPX](https://upx.github.io/) can be used to bring the size down even futher.</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;## Rendering backend</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;See `README` into `custom_backend` folder</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;## GLFW backend</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;See `README` into `custom_backend` folder</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;The GLFW backend was made to demonstrate how to write a backend but it is complete enough to be used by default.</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;The GLFW backend has a cool lightweight Lua example which setup a Processing-like environment making use of the parallelism feature of the library, allowing the user to prototype multithreaded graphical stuff without C code compilation through the Lua language.</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;## OpenGL ES 2 backend</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;See `README` into `custom_backend` folder</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;## GBA backend</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;See `README` into `custom_backend` folder</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;## Screenshots</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;![Full example screenshot with three threads](/screenshot1.png?raw=true &quot;Full example screenshot with three threads&quot;)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;![Tunnel with four threads](/screenshot2.png?raw=true &quot;Tunnel with four threads&quot;)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;![Earth with four threads](/screenshot3.png?raw=true &quot;Earth with four threads&quot;)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;![Flags of the world with four threads](/screenshot4.png?raw=true &quot;Flags of the world with four threads&quot;)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;![Compositing with three threads](/screenshot5.png?raw=true &quot;Compositing with three threads&quot;)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;## License</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;BSD, see LICENSE file</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 25 2021 19:10:56 for FB Graphics by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
